# DNS 服务器


DNS 是实现域名到 IP 转换的网络协议，当访问网页的时候，浏览器首先会通过 DNS 协议把域名转换为 IP，然后再向这个 IP 发送 HTTP 请求。



## DNS 原理

1. 标识计算机是使用 IP 地址，IPv4 有 32 位，IPv6 有 128 位。

``` 
192.10.128.240

3C0B:0000:2667:BC2F:0000:0000:4669:AB4D

```

我们访问网站的时候，输入的是域名，比如 `www.example.com`。而不是 IP 地址。 

名字和 IP 的绑定关系是可以变的，每次访问都要经历一次解析名字对应的 IP 的过程。这个名字就叫做域名。

2. 如何维护域名和 IP 的对应关系？

最简单的方式就是在一个文件里 记录域名和 IP 的对应关系，这个文件就是 `hosts` 文件。

但是随着机器增多，这个文件会变得非常庞大。并且很容易出现命名冲突。

所以域名服务器得是分布式的，通过多台服务器来提供服务，并且最好还能通过命名空间来划分，减少命名冲突。

但是这样设计还是有问题的，每一级域一个服务器，如果域名的层次过多，那么就要往返查询好多次，效率也不高。

所以 DNS（Domain Name System）只分了三级域名服务器：

 + 根域名服务器：记录着所有顶级域名服务器的地址，是域名解析的入口
 + 顶级域名服务器：记录着各个二级域名对应的服务器的地址
 + 权威域名服务器：该域下二级、三级甚至更多级的域名都在这里解析


3. Time-To-Live

每次查询还是比较耗时的，查询完之后要把结果缓存下来，并且设置一个过期时间，域名解析记录在 DNS 服务器上的缓存时间叫做 TTL


所以 DNS 设计了一层本地域名服务器，由它来负责完成域名的解析，并且把结果缓存下来。

这样某台具体的机器只要向这个本地域名服务器发请求就可以了，而且解析结果其他机器也可以直接用。

